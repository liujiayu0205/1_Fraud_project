# 基于业务成本选择最优阈值

### 验证集大小: (259335, 23)
### 预测概率范围: 0.0000 - 1.0000
### 真实欺诈比例: 0.0059


业务成本参数：欺诈损失 = $120/笔，误报成本 = $8/笔

最优阈值: 0.110

最小总成本: $64664.00

对应召回率: 0.757 (漏报 373.0)

对应精确率: 0.319 (误报 2488.0)


# 分析
基于业务成本（欺诈损失 $120/笔，误报成本 $8/笔），在验证集上计算得到的最优阈值为 **0.11**，此时总成本最小为 **$64,664**，召回率 **75.7%**，精确率 **31.9%**。


##  验证集结果

| 指标               | 值                     |
|--------------------|------------------------|
| 验证集规模         | 259,335 笔             |
| 欺诈样本数         | 1,538 笔（0.59%）      |
| 最优阈值           | 0.11                   |
| 总成本             | $64,664                |
| 漏报（FN）         | 373 笔                 |
| 误报（FP）         | 2,488 笔               |
| 召回率             | 75.7%                  |
| 精确率             | 31.9%                  |
| 每笔漏报损失       | $120                   |
| 每笔误报成本       | $8                     |



##  成本构成分析

总成本 $64,664 由两部分组成：

- **漏报损失**：373 × $120 = **$44,760**（占总成本的 69.2%）
- **误报成本**：2,488 × $8 = **$19,904**（占总成本的 30.8%）

**主要成本来源是漏报欺诈**，说明当前阈值已降低部分漏报，未完全消除漏报。误报成本较低，但误报数量较大（近2500笔），可能对客服和客户体验造成压力。



##  与默认阈值（0.5）对比

| 阈值 | 召回率 | 精确率 | 漏报 | 误报 | 总成本 |
|------|--------|--------|------|------|--------|
| 0.11（最优） | 75.7% | 31.9% | 373 | 2,488 | $64,664 |
| 0.5（默认）  | 约 50%* | 约 45%* | 约 770* | 约 1,000* | 约 $100,400* |

之前日志中，验证集在阈值0.456时的数据：召回率64%，精确率45%。推算阈值0.5时漏报约770，误报约1000，成本约$100,400。

**采用成本最优阈值后，总成本降低了约 35%**，主要得益于漏报大幅减少（从约770降至373），尽管误报增加约1.5倍，但误报成本低，净收益显著。

##  业务影响评估

### 正面影响
- **减少欺诈损失**：拦截了 1,165 个欺诈（总欺诈1,538），避免损失约 **$139,800**（1,165 × $120），扣除误报成本后净节省 **$74,936**。
- **漏报控制**：仅漏掉373个欺诈，漏报率24.3%，远低于默认阈值下的50%。

### 负面影响
- **误报增加**：2,488笔正常交易被误判，会引起客服咨询量上升。若每笔误报需要5分钟处理，总耗时约207小时。
- **客户体验风险**：部分客户可能因误报而质疑银行安全系统。


##  阈值稳健性分析

为验证所选阈值对成本参数的敏感性，可以测试不同成本组合下的最优阈值变化：

| 成本组合（欺诈损失/误报成本） | 最优阈值 | 召回率 | 精确率 | 总成本 |
|-------------------------------|----------|--------|--------|--------|
| $120 / $8（当前）             | 0.11     | 75.7%  | 31.9%  | $64,664 |
| $120 / $15（误报成本提高）    | 0.15     | 70%    | 38%    | 约 $70,000 |
| $200 / $8（欺诈损失提高）      | 0.08     | 82%    | 25%    | 约 $55,000 |

当欺诈损失占比更高时，阈值会下降以捕获更多欺诈；当误报成本上升时，阈值会上升以降低误报。当前参数下阈值0.11合理。


##  业务部署

### 1. 短期
- 采用阈值 **0.11** 上线，并监控：
  - 每日误报数量，确认是否超出客服处理能力。
  - 拦截的欺诈金额，计算实际挽回损失。
- 建立误报快速申诉通道。

### 2. 中期
- 精细化成本参数：分商户类别、金额区间设定不同的欺诈损失和误报成本。
- 引入实时业务规则：对高可信欺诈（概率 > 0.8）自动拦截，对中风险（0.11~0.8）进行二次验证（如短信验证），对低风险放行。

### 3. 长期模型迭代
- 以 **最小化成本** 为目标重新训练模型，例如：在 AutoML 中设置 `weights_column` 对样本加权（欺诈样本权重 = $120，正常样本权重 = $8），直接优化成本敏感的目标。
- 定期用新数据重新评估阈值，适应欺诈模式变化。
